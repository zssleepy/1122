<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>贺州市金琪矿业环境监测系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI','Microsoft YaHei',sans-serif}body{background:linear-gradient(135deg,#0a1a2a,#0d2b3e);color:#e0e7ff;overflow:hidden;height:100vh;display:flex;flex-direction:column}.company-header{background:linear-gradient(to right,#0d5a7e,#0a3a55);color:white;padding:12px 20px;box-shadow:0 4px 15px rgba(0,0,0,0.3);border-bottom:3px solid #4CAF50;display:flex;justify-content:space-between;align-items:center;z-index:1000}.header-left,.header-right{display:flex;align-items:center;gap:15px}.header-icon{font-size:2.2rem;color:#4CAF50;text-shadow:0 0 15px rgba(76,175,80,0.6)}.company-title{font-size:1.8rem;margin:0;background:linear-gradient(90deg,#ffffff,#e0f7ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:700;letter-spacing:0.5px}.company-subtitle{font-size:1.1rem;opacity:0.85;margin-top:4px;color:#a8e6ff;font-weight:300}#app{display:flex;flex:1;overflow:hidden;position:relative;gap:20px;padding:20px}.map-container-wrapper{flex:1;background:rgba(18,32,50,0.8);border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.5);padding:15px;display:flex;flex-direction:column;height:calc(100vh - 120px);min-width:800px;position:relative}#map-container{flex:1;position:relative;overflow:hidden;border-radius:8px;border:1px solid rgba(74,175,80,0.3);background:#0a1a2a}#map{width:100%;height:100%;background:#0a1a2a;border-radius:8px}.data-sidebar{width:380px;background:rgba(18,32,50,0.92);border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.5);padding:20px;display:flex;flex-direction:column;height:calc(100vh - 120px);border:1px solid rgba(74,175,80,0.3)}.data-sidebar.empty{align-items:center;justify-content:center;color:#a8e6ff;font-size:1.1rem}.control-panel{width:380px;background:rgba(18,32,50,0.92);backdrop-filter:blur(10px);box-shadow:-5px 0 25px rgba(0,0,0,0.4);padding:20px;overflow-y:auto;position:relative;display:none;border-left:1px solid rgba(74,175,80,0.3);transition:all 0.3s ease;z-index:900}.control-panel.active{display:block}.control-panel.collapsed{width:40px !important;padding:0 !important;overflow:hidden}.control-panel.collapsed .panel-content{display:none}.control-panel.collapsed .panel-top-buttons{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:10px 0;height:100%}.control-panel.collapsed .panel-top-buttons .export-btn{display:none}.control-panel.collapsed .panel-top-buttons .collapse-btn{width:30px;height:30px;margin:5px 0;display:flex;align-items:center;justify-content:center;border-radius:50%;background:rgba(74,175,80,0.3)}.panel-title{font-size:1.3rem;color:#e0f7ff;margin-bottom:20px;padding-bottom:12px;border-bottom:2px solid #4CAF50;font-weight:600}.form-group{margin-bottom:18px}label{display:block;margin-bottom:8px;font-weight:600;color:#b0d0ff;font-size:0.95rem}input,select,textarea{width:100%;padding:12px;border:1px solid rgba(74,175,80,0.3);border-radius:6px;font-size:0.95rem;background-color:rgba(10,26,42,0.6);color:#e0f7ff;transition:all 0.2s ease}input[type="date"]::-webkit-calendar-picker-indicator{filter:invert(0.8);cursor:pointer}input:focus,select:focus,textarea:focus{outline:none;border-color:#4CAF50;box-shadow:0 0 0 3px rgba(76,175,80,0.2)}textarea{height:100px;resize:vertical}button{background:linear-gradient(135deg,#4CAF50,#3d8b40);color:white;border:none;padding:14px 0;width:100%;border-radius:8px;font-size:1rem;cursor:pointer;transition:all 0.3s;font-weight:600;letter-spacing:0.5px;box-shadow:0 4px 12px rgba(0,0,0,0.2)}button:hover{transform:translateY(-2px);box-shadow:0 6px 15px rgba(76,175,80,0.4)}button:disabled{background:#445566;cursor:not-allowed;opacity:0.6}.data-content{flex:1;overflow-y:auto;padding-right:10px}.data-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;padding-bottom:15px;border-bottom:2px solid rgba(74,175,80,0.4)}.data-subheader{display:flex;justify-content:space-between;align-items:center;margin-top:20px}.data-subheader h4{margin:0}.close-btn{background:rgba(255,255,255,0.1);color:#a8e6ff;border:1px solid rgba(255,255,255,0.2);border-radius:50%;width:30px;height:30px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.3s ease;box-shadow:none}.close-btn:hover{background:#e74c3c;color:white;border-color:transparent;transform:scale(1.1) rotate(90deg);box-shadow:0 0 15px rgba(231,76,60,0.6)}.admin-panel-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:2000;display:none;justify-content:center;align-items:center}.admin-panel-content{background:rgba(15,30,45,0.98);border-radius:15px;box-shadow:0 15px 40px rgba(0,0,0,0.8);padding:35px;width:480px;max-width:90%;color:#ecf0f1;backdrop-filter:blur(12px);border:1px solid rgba(74,175,80,0.4);position:relative}.admin-panel-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding-bottom:20px;border-bottom:2px solid rgba(230,126,34,0.45)}.admin-panel-title{font-size:1.9rem;color:#e67e22;display:flex;align-items:center;gap:15px}.map-switcher{display:flex;gap:10px;background:rgba(20,40,60,0.8);padding:8px;border-radius:30px;backdrop-filter:blur(8px);border:1px solid rgba(74,175,80,0.3)}.map-switch-btn{background:rgba(25,45,65,0.7);color:#4ab0d9;border:1px solid #4ab0d9;padding:10px 22px;border-radius:25px;cursor:pointer;transition:all 0.3s ease;font-size:0.95rem;font-weight:500;display:flex;align-items:center;gap:8px}.map-switch-btn.active{background:linear-gradient(135deg,#4ab0d9,#3498db);color:white;box-shadow:0 0 20px rgba(52,152,219,0.6);border-color:transparent}.map-switch-btn:hover:not(.active){background:rgba(74,176,217,0.3)}.admin-toggle-btn{background:linear-gradient(135deg,#e67e22,#d35400);color:white;border:none;padding:12px 12px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.3s ease;font-size:1.2rem;width:44px;height:44px;box-shadow:0 4px 15px rgba(230,126,34,0.5)}.admin-toggle-btn:hover{background:linear-gradient(135deg,#d35400,#e67e22);transform:translateY(-2px) scale(1.05);box-shadow:0 6px 20px rgba(230,126,34,0.6)}.admin-toggle-btn.logged-in{background:linear-gradient(135deg,#27ae60,#2ecc71);box-shadow:0 4px 15px rgba(46,204,113,0.5)}.admin-toggle-btn.logged-in:hover{background:linear-gradient(135deg,#2ecc71,#27ae60)}.custom-marker{position:absolute;cursor:pointer;transition:all 0.3s ease;filter:drop-shadow(0 4px 10px rgba(0,0,0,0.7));z-index:500}.custom-marker:hover,.custom-marker.highlight{transform:scale(1.2);z-index:1000}.marker-pin{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px rgba(0,0,0,0.6);border:2px solid white;transition:all 0.3s ease}.marker-label{position:absolute;background:rgba(0,0,0,0.85);color:white;padding:5px 12px;border-radius:20px;font-size:13px;font-weight:bold;white-space:nowrap;top:-12px;left:32px;min-width:30px;text-align:center;box-shadow:0 3px 8px rgba(0,0,0,0.4)}#devtools-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:#0a1a2a;z-index:9999;display:flex;justify-content:center;align-items:center;flex-direction:column;color:white;text-align:center;padding:20px;display:none}.value-info{font-size:0.85rem;color:#a8e6ff;margin-top:4px;display:block}.github-config-section{margin-top:20px;padding-top:20px;border-top:1px solid rgba(74,175,80,0.3)}.github-config-title{font-size:1.1rem;color:#e0f7ff;margin-bottom:15px;display:flex;align-items:center;gap:10px}.cloud-sync-btn{background:linear-gradient(135deg,#3498db,#2980b9);display:flex;align-items:center;justify-content:center;gap:8px;padding:12px 0}.sync-status{margin-top:10px;padding:8px;border-radius:6px;text-align:center;font-size:0.9rem;display:none}.sync-success{background:rgba(46,204,113,0.2);border:1px solid rgba(46,204,113,0.4);color:#2ecc71}.sync-error{background:rgba(231,76,60,0.2);border:1px solid rgba(231,76,60,0.4);color:#e74c3c}.sync-loading{background:rgba(52,152,219,0.2);border:1px solid rgba(52,152,219,0.4);color:#3498db}.last-sync{font-size:0.8rem;color:#a8e6ff;margin-top:10px;text-align:center;display:none}.data-table{width:100%;border-collapse:collapse;margin:10px 0;font-size:0.9rem}.data-table th,.data-table td{padding:8px 12px;text-align:left;border-bottom:1px solid rgba(74,175,80,0.2)}.data-table th{background:rgba(74,175,80,0.15);color:#4CAF50;font-weight:600}.data-table tr:hover{background:rgba(74,175,80,0.1)}.action-btn{padding:8px 12px;margin:4px;font-size:0.85rem;border-radius:4px;transition:all 0.2s}.btn-primary{background:linear-gradient(135deg,#3498db,#2980b9)}.btn-warning{background:linear-gradient(135deg,#f39c12,#e67e22)}.btn-danger{background:linear-gradient(135deg,#e74c3c,#c0392b)}.point-item{background:rgba(10,26,42,0.6);border-radius:8px;padding:15px;margin-bottom:15px;border:1px solid rgba(74,175,80,0.2);transition:all 0.3s;cursor:pointer}.point-item:hover{background:rgba(74,175,80,0.1);border-color:rgba(74,175,80,0.4);transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.2)}.point-item strong{color:#4CAF50;font-size:1.1rem}.point-item .point-meta{display:flex;justify-content:space-between;font-size:0.9rem;color:#b0d0ff;margin-top:4px}.toast-message{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.8);color:white;padding:12px 24px;border-radius:30px;z-index:3000;opacity:0;transition:opacity 0.3s;font-size:0.95rem;box-shadow:0 5px 15px rgba(0,0,0,0.3);pointer-events:none}.toast-message.show{opacity:1}.toast-message.info{border-left:4px solid #3498db}.toast-message.success{border-left:4px solid #2ecc71}.toast-message.error{border-left:4px solid #e74c3c}.location-hint{position:absolute;top:20px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.8);color:#fff;padding:10px 20px;border-radius:30px;z-index:1000;display:none;font-size:0.9rem;box-shadow:0 4px 15px rgba(0,0,0,0.4);border:1px solid rgba(74,175,80,0.3)}.map-center-container{display:flex;justify-content:center;align-items:center;width:100%;height:100%;overflow:auto}.map-image{max-width:100%;max-height:100%;object-fit:contain}.tab-buttons{display:flex;margin-bottom:20px;border-bottom:1px solid #4CAF50}.tab-button{width:50%;background:transparent;border:none;padding:12px;cursor:pointer;color:#a8e6ff;font-size:1rem;border-radius:6px 6px 0 0;transition:all 0.3s}.tab-button.active{background:rgba(76,175,80,0.2);color:#fff;border-bottom:3px solid #4CAF50}.tab-content{display:none}.tab-content.active{display:block}.panel-top-buttons{position:absolute;top:10px;right:10px;display:flex;gap:5px}.panel-top-buttons button{width:30px;height:30px;padding:0;background:rgba(74,175,80,0.3);border-radius:50%}.custom-marker.draggable{cursor:grab}.custom-marker.draggable:active{cursor:grabbing}.drag-hint{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.8);color:#fff;padding:10px 20px;border-radius:30px;z-index:1000;font-size:0.9rem;box-shadow:0 4px 15px rgba(0,0,0,0.4);border:1px solid rgba(74,175,80,0.3)}#github-sync-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:4000;display:none;justify-content:center;align-items:center;backdrop-filter:blur(5px)}#github-sync-content{background:rgba(15,30,45,0.98);border-radius:15px;box-shadow:0 15px 40px rgba(0,0,0,0.8);padding:35px;width:500px;max-width:90%;color:#ecf0f1;border:1px solid rgba(52,152,219,0.4)}#github-sync-content h2{font-size:1.9rem;color:#3498db;margin-bottom:25px;padding-bottom:15px;border-bottom:2px solid rgba(52,152,219,0.4);display:flex;align-items:center;gap:15px}#sync-modal-status{margin-top:15px;padding:10px;border-radius:6px;text-align:center;font-size:0.95rem;display:none}#github-sync-content .button-group{display:flex;gap:15px;margin-top:25px}.sidebar-sequence-input{background-color:rgba(10,26,42,0.8);color:#e0f7ff;border:1px solid rgba(74,175,80,0.3);border-radius:4px;padding:2px 6px;width:60px;text-align:center;margin-left:5px}.sidebar-sequence-input:focus{outline:none;border-color:#4CAF50;box-shadow:0 0 0 2px rgba(76,175,80,0.2)}
    </style>
</head>
<body>

    <div id="devtools-overlay"><h1><i class="fas fa-lock"></i> 访问受限</h1><p>为保护系统安全，开发者工具访问已被阻止。如需访问系统功能，请关闭开发者工具并刷新页面。</p></div>
    <header class="company-header"><div class="header-left"><i class="fas fa-industry header-icon"></i><div><h1 class="company-title">贺州市金琪矿业有限责任公司</h1><p class="company-subtitle">环境监测系统</p></div></div><div class="header-right"><div class="map-switcher"><button class="map-switch-btn active" id="b1">张公岭监测点位图</button><button class="map-switch-btn" id="b2">龙水监测点位图</button></div><button class="admin-toggle-btn" id="b3" title="管理员登录/登出"><i class="fas fa-user-lock"></i></button></div></header>
    <main id="app">
        <div class="map-container-wrapper"><div id="map-container"><div id="map" class="map-center-container"><img id="d1" class="map-image" src="233.jpg" alt="地图"></div><div class="location-hint" id="d2"><i class="fas fa-crosshairs"></i> 请点击地图选择点位位置</div><div class="drag-hint" id="d3" style="display: none;"><i class="fas fa-arrows-alt"></i> 拖动点位调整位置</div></div></div>
        <aside class="data-sidebar empty" id="m1"><i class="fas fa-map-marker-alt" style="font-size: 3rem; color: rgba(74, 175, 80, 0.5); margin-bottom: 20px;"></i><p>点击地图上的点位查看详细信息</p></aside>
        <aside class="control-panel" id="m2">
            <div class="panel-top-buttons"><button class="export-btn" title="导出Excel"><i class="fas fa-file-export"></i></button><button class="collapse-btn" title="收缩面板"><i class="fas fa-chevron-left"></i></button></div>
            <div class="panel-content"><div class="tab-container"><div class="tab-buttons"><button class="tab-button active" id="t1">添加/编辑记录</button><button class="tab-button" id="t2">管理点位</button></div>
                    <div id="tc1" class="tab-content active"><h2 class="panel-title">添加/编辑监测数据</h2><div class="form-group"><label for="f1">选择点位</label><select id="f1" disabled><option value="new-point">--- 新建点位 ---</option></select></div><div class="form-group"><label for="f2">序号</label><input type="number" id="f2" placeholder="点位排序, 例如: 1" disabled><span class="value-info">用于排序和导入导出识别</span></div><div class="form-group"><label for="f3">点位编号</label><input type="text" id="f3" placeholder="例如: W1, W2" disabled></div><div class="form-group"><label for="f4">点位名称</label><input type="text" id="f4" placeholder="例如: 1# xxxx" disabled></div><div class="form-group"><label for="f5">水体类型</label><select id="f5" disabled><option value="surface">地表水</option><option value="ground">地下水</option></select></div><hr style="border-color: rgba(74, 175, 80, 0.2); margin: 20px 0;"><div class="form-group"><label for="f6">监测时间</label><input type="date" id="f6" disabled></div><div class="form-group"><label for="f7">录入人</label><input type="text" id="f7" placeholder="输入录入人姓名" disabled></div><div class="form-group"><label for="f8">锌监测值(mg/L)</label><input type="text" id="f8" placeholder="输入锌监测值 (可输入 <0.01)" disabled><span class="value-info">可输入数字或"<0.01"等文本</span></div><div class="form-group"><label for="f9">锰监测值(mg/L)</label><input type="text" id="f9" placeholder="输入锰监测值 (可输入 <0.01)" disabled><span class="value-info">可输入数字或"<0.01"等文本</span></div><div class="form-group"><label for="f10">现场情况记录</label><textarea id="f10" placeholder="记录现场情况..." disabled></textarea></div><div class="form-group"><button id="f11" class="action-btn btn-warning" style="width: 100%; display: none;"><i class="fas fa-map-marker-alt"></i> 选择地图点位位置</button></div><button id="f12" disabled>保存监测数据</button></div>
                    <div id="tc2" class="tab-content"><h2 class="panel-title">点位管理</h2><div id="l1" class="point-list"></div></div></div>
                <div class="github-config-section"><h3 class="github-config-title"><i class="fab fa-github"></i> GitHub云端存储配置</h3><div class="form-group"><label for="g1">仓库拥有者</label><input type="text" id="g1" placeholder="输入GitHub用户名"></div><div class="form-group"><label for="g2">仓库名称</label><input type="text" id="g2" placeholder="输入仓库名称"></div><div class="form-group"><label for="g3">数据文件名</label><input type="text" id="g3" value="data.json" placeholder="例如: data.json"></div><div class="form-group"><label for="g4">GitHub个人访问令牌</label><input type="password" id="g4" placeholder="输入GitHub访问令牌"><span class="value-info">需要repo权限（仅管理员使用）</span></div><button class="cloud-sync-btn" id="g5b1"><i class="fas fa-cloud-upload-alt"></i> 保存数据到云端</button><button class="cloud-sync-btn" id="g5b2" style="margin-top: 10px; background: linear-gradient(135deg, #1abc9c, #16a085);"><i class="fas fa-cloud-download-alt"></i> 从云端加载数据</button><div id="g6" class="sync-status"></div><div id="g7" class="last-sync"></div></div></div>
        </aside>
    </main>
    <div class="admin-panel-overlay" id="ap1"><div class="admin-panel-content"><div class="admin-panel-header"><h2 class="admin-panel-title"><i class="fas fa-lock"></i> 管理员登录</h2><button class="close-btn" id="ap2"><i class="fas fa-times"></i></button></div><div class="form-group"><label for="ap3">管理密码</label><input type="password" id="ap3" placeholder="请输入管理密码"></div><button id="ap4" class="btn-primary"><i class="fas fa-sign-in-alt"></i> 登录验证</button></div></div>
    <div class="admin-panel-overlay" id="gs1"><div id="github-sync-content"><h2><i class="fas fa-sync-alt"></i> 同步云端数据</h2><p style="margin-bottom: 20px; color: #bdc3c7;">请输入GitHub个人访问令牌以从云端同步最新数据。也可以跳过此步骤，使用本地缓存的数据。</p><div class="form-group"><label for="gs2">GitHub 个人访问令牌 (PAT)</label><input type="password" id="gs2" placeholder="粘贴令牌到此处"></div><div id="gs3" class="sync-status"></div><div class="button-group"><button id="gs4" class="btn-warning" style="background: linear-gradient(135deg, #f39c12, #e67e22);"><i class="fas fa-times"></i> 跳过并使用本地数据</button><button id="gs5" class="btn-primary"><i class="fas fa-cloud-download-alt"></i> 同步数据</button></div></div></div>
    <div class="toast-message" id="toast1"></div>
    <script>
    document.addEventListener('DOMContentLoaded',()=>{const K={owner:'zssleepy',repo:'1122',file:'data.json'},P='kkhhjjj',C={'233':{imageUrl:'233.jpg',intrinsicWidth:1776,intrinsicHeight:907},'666':{imageUrl:'666.jpg',intrinsicWidth:1920,intrinsicHeight:1279}},I={surface:{className:'custom-marker',html:'<div class="marker-pin" style="background:#4CAF50"><i class="fas fa-water"></i></div><div class="marker-label"></div>',iconAnchor:[16,32]},ground:{className:'custom-marker',html:'<div class="marker-pin" style="background:#1abc9c"><i class="fas fa-tint"></i></div><div class="marker-label"></div>',iconAnchor:[16,32]}};const S={l:!1,c:'233',d:{'233':[],'666':[]},m:null,ml:null,s:null,e:null,ig:!1,dx:0,dy:0,de:null,dp:null,sl:!1,};const E={mc:document.getElementById('map-container'),mi:document.getElementById('d1'),ds:document.getElementById('m1'),cp:document.getElementById('m2'),pc:document.getElementById('l1'),t:document.getElementById('toast1'),ls:document.getElementById('d2'),dh:document.getElementById('d3'),b1:document.getElementById('b1'),b2:document.getElementById('b2'),atb:document.getElementById('b3'),alb:document.getElementById('ap4'),slb:document.getElementById('f11'),sb:document.getElementById('f12'),spd:document.getElementById('f1'),s1:document.getElementById('f2'),s2:document.getElementById('f3'),s3:document.getElementById('f4'),s4:document.getElementById('f5'),s5:document.getElementById('f6'),s6:document.getElementById('f7'),s7:document.getElementById('f8'),s8:document.getElementById('f9'),s9:document.getElementById('f10'),apo:document.getElementById('ap1'),apc:document.getElementById('ap2'),api:document.getElementById('ap3'),t1:document.getElementById('t1'),t2:document.getElementById('t2'),tc1:document.getElementById('tc1'),tc2:document.getElementById('tc2'),g5b1:document.getElementById('g5b1'),g5b2:document.getElementById('g5b2'),g6:document.getElementById('g6'),g7:document.getElementById('g7'),g1:document.getElementById('g1'),g2:document.getElementById('g2'),g3:document.getElementById('g3'),g4:document.getElementById('g4'),dvo:document.getElementById('devtools-overlay'),gs1:document.getElementById('gs1'),gs2:document.getElementById('gs2'),gs5:document.getElementById('gs5'),gs4:document.getElementById('gs4'),gs3:document.getElementById('gs3'),};const _t=(m,t='info')=>{E.t.textContent=m;E.t.className=`toast-message show ${t}`;setTimeout(()=>E.t.classList.remove('show'),4000)};const u1=(m,t,s=E.g6)=>{s.textContent=m;s.className=`sync-status ${t}`;s.style.display='block';if(t!=='sync-loading')setTimeout(()=>{s.style.display='none'},5000)};const u2=()=>{E.g7.textContent=`最后同步: ${new Date().toLocaleString()}`;E.g7.style.display='block'};const b1=(s)=>btoa(encodeURIComponent(s).replace(/%([0-9A-F]{2})/g,(m,p)=>String.fromCharCode('0x'+p)));const b2=(s)=>decodeURIComponent(atob(s).split('').map(c=>'%'+('00'+c.charCodeAt(0).toString(16)).slice(-2)).join(''));const p1=(i)=>{if(i===null||i===undefined)return null;const t=String(i).trim();if(t==='')return null;const n=Number(t);if(!isNaN(n)&&String(n)===t)return n;return t};const f1=(v)=>{if(v===null||v===undefined)return'';return v};const f2=(v)=>{if(v===null||v===undefined)return'未记录';if(typeof v==='string'&&v.startsWith('<')){const s=v.replace(/</g,'<');return`<span style="color:#FF9800; font-weight: bold;">${s}</span>`}return v};const s1=(r)=>{if(r&&r.length>1){r.sort((a,b)=>new Date(b.monitoringDate)-new Date(a.monitoringDate))}};const g1=(w)=>({surface:'地表水',ground:'地下水'}[w]||w);function g2(){const i=E.mi,c=E.mc;const w=i.naturalWidth,h=i.naturalHeight;const r=c.getBoundingClientRect();if(!w||!h||!r.width||!r.height)return{displayedWidth:0,displayedHeight:0,offsetX:0,offsetY:0};const cw=r.width,ch=r.height;let dw,dh,ox,oy;if(cw/ch>w/h){dh=ch;dw=w*(dh/h);ox=(cw-dw)/2;oy=0}else{dw=cw;dh=h*(dw/w);ox=0;oy=(ch-dh)/2}return{displayedWidth:dw,displayedHeight:dh,offsetX:ox,offsetY:oy}}function l1(){try{const d=localStorage.getItem('allMapsPointsData');if(d){S.d=JSON.parse(d);if(!S.d['233'])S.d['233']=[];if(!S.d['666'])S.d['666']=[];Object.values(S.d).flat().forEach(p=>s1(p.records))}}catch(e){console.error("e1:",e);S.d={'233':[],'666':[]}}}function s3(){localStorage.setItem('allMapsPointsData',JSON.stringify(S.d))}const c1=(a,n,o='系统')=>({id:Date.now(),action:a,note:n,timestamp:new Date().toLocaleString(),operator:o});function a2(){if(!S.l)return _t('无操作权限，请先登录管理员。','error');const v1=E.s1.value?parseInt(E.s1.value,10):null;const v2=E.s2.value.trim();const v3=E.s3.value.trim();const v4=E.s4.value;const v5=E.s5.value;const v6=E.s6.value.trim();const v7=p1(E.s7.value);const v8=p1(E.s8.value);const v9=E.s9.value;if(!v3||!v2||!v5||!v6)return _t('点位名称、编号、监测时间和录入人不能为空！','error');if(v1!==null&&isNaN(v1))return _t('序号必须是数字！','error');const p=S.d[S.c];const ap=[...S.d['233'],...S.d['666']];if(S.s){const x=p.find(p=>p.id===S.s);if(!x)return;if(ap.some(p=>p.sequence===v1&&p.id!==S.s))return _t('该序号已存在！','error');if(ap.some(p=>p.code===v2&&p.id!==S.s))return _t('点位编号已存在！','error');x.sequence=v1;x.name=v3;x.code=v2;x.waterType=v4;const n={zinc:v7,manganese:v8,notes:v9,operator:v6,monitoringDate:v5};if(S.e){const ri=x.records.findIndex(r=>r.id===S.e);if(ri!==-1){x.records[ri]={...x.records[ri],...n};_t(`点位 "${x.name}" 的记录已更新！`,'success')}}else{if(v7!==null||v8!==null||v9){if(!x.records)x.records=[];const fr={...n,id:Date.now(),timestamp:new Date().toLocaleString()};x.records.push(fr);_t(`为点位 "${x.name}" 添加了新记录！`,'success')}else{_t('点位信息已更新，但未添加新的监测数据。','info')}}s1(x.records)}else{if(!S.ml)return _t('请先在地图上选择点位位置！','error');if(ap.some(p=>p.sequence===v1))return _t('该序号已存在！','error');if(ap.some(p=>p.code===v2))return _t('点位编号已存在！','error');const np={id:Date.now(),mapId:S.c,sequence:v1,code:v2,name:v3,waterType:v4,lat:S.ml.lat,lng:S.ml.lng,timestamp:new Date().toLocaleString(),records:[],history:[c1('创建点位','新建监测点位',v6)]};if(v7!==null||v8!==null||v9){np.records.push({id:Date.now(),zinc:v7,manganese:v8,notes:v9,timestamp:new Date().toLocaleString(),operator:v6,monitoringDate:v5});s1(np.records)}p.push(np);c2(np);_t('新点位添加成功！','success')}s3();r2();r3();p3();if(S.s)d4(S.s)}function exportToExcel(){const ar=[];Object.values(S.d).flat().forEach(p=>(p.records||[]).forEach(r=>{ar.push({'日期':r.monitoringDate||r.timestamp.split(' ')[0],'水体类型':g1(p.waterType||'surface'),'序号':p.sequence??'','点位名称':p.name,'锌(mg/L)':f1(r.zinc),'锰(mg/L)':f1(r.manganese)})}));if(ar.length===0)return _t('没有记录可以导出。','info');ar.sort((a,b)=>new Date(a['日期'])-new Date(b['日期']));const w=XLSX.utils.book_new();const s=XLSX.utils.json_to_sheet(ar);XLSX.utils.book_append_sheet(w,s,"监测数据总表");XLSX.writeFile(w,"环境监测数据.xlsx");_t('数据已导出为 Excel 文件！','success')}function i1(){E.mi.src=C[S.c].imageUrl;E.mi.onload=r1;if(E.mi.complete)r1()}function s2(m){if(S.c===m)return;S.c=m;E.b1.classList.toggle('active',m==='233');E.b2.classList.toggle('active',m==='666');i1();d5();r3();r2();p3();_t(`已切换至 ${m==='233'?'张公岭监测点位图':'龙水监测点位图'}`,'info')}function r1(){document.querySelectorAll('.custom-marker:not(.marker-temp)').forEach(m=>m.remove());(S.d[S.c]||[]).forEach(p=>c2(p));E.dh.style.display=S.l?'block':'none'}function c2(p,i=!1){const c=I[p.waterType||'surface'];let m=document.createElement('div');m.className=`${c.className} ${i?'marker-temp':''}`;m.innerHTML=c.html;m.dataset.pointId=p.id;m.dataset.waterType=p.waterType;const{displayedWidth:dw,displayedHeight:dh,offsetX:ox,offsetY:oy}=g2();if(dw===0)return m;const mc=C[S.c];const xp=ox+(p.lng/mc.intrinsicWidth)*dw;const yp=oy+(p.lat/mc.intrinsicHeight)*dh;m.style.position='absolute';m.style.left=`${xp-c.iconAnchor[0]}px`;m.style.top=`${yp-c.iconAnchor[1]}px`;m.querySelector('.marker-label').textContent=p.code||p.name||'';E.mc.appendChild(m);if(!i){m.addEventListener('click',e=>{e.stopPropagation();d4(p.id)});if(S.l){m.classList.add('draggable');m.addEventListener('mousedown',h6)}}return m}function d4(i){const p=(S.d[S.c]||[]).find(x=>x.id===i);if(!p)return;S.s=i;document.querySelectorAll('.custom-marker').forEach(m=>m.classList.remove('highlight'));document.querySelector(`.custom-marker[data-point-id="${i}"]`)?.classList.add('highlight');const a=S.l?`<button class="action-btn btn-primary quick-add-record-btn" data-point-id="${i}" style="padding: 6px 10px; font-size: 0.8rem; width: auto;"><i class="fas fa-plus"></i> 添加新记录</button>`:'';const rh=(p.records||[]).map(r=>`<tr data-record-id="${r.id}"><td>${r.monitoringDate||r.timestamp.split(' ')[0]}</td><td>${f2(r.zinc)}</td><td>${f2(r.manganese)}</td><td>${r.operator||'未知'}</td><td class="admin-only-cell" style="${S.l?'':'display: none;'}"><button class="action-btn btn-warning edit-record-btn" data-record-id="${r.id}" title="编辑"><i class="fas fa-edit"></i></button><button class="action-btn btn-danger delete-record-btn" data-record-id="${r.id}" title="删除"><i class="fas fa-trash"></i></button></td></tr>`).join('');const pi=S.l?` | 序号: <input type="number" class="sidebar-sequence-input" data-point-id="${i}" value="${p.sequence??''}" title="编辑后失焦或按回车保存">`:'';E.ds.innerHTML=`<div class="data-content"><div class="data-header"><h3>${p.name} (${p.code||'无编号'})</h3><button class="close-btn" title="关闭"><i class="fas fa-times"></i></button></div><p><strong>水体类型:</strong> ${g1(p.waterType||'surface')}${pi}</p><div class="data-subheader"><h4>记录历史 (共 ${p.records?.length||0} 条)</h4> ${a}</div><div style="max-height: 380px; overflow-y: auto; margin-top: 10px;"><table class="data-table"><thead><tr><th>监测时间</th><th>锌</th><th>锰</th><th>录入员</th><th class="admin-only-cell" style="${S.l?'':'display: none;'}">操作</th></tr></thead><tbody>${rh||`<tr><td colspan="5" style="text-align:center;">暂无历史记录</td></tr>`}</tbody></table></div></div>`;E.ds.classList.remove('empty');E.ds.querySelector('.close-btn').addEventListener('click',d5);if(S.l){E.ds.querySelectorAll('.edit-record-btn').forEach(b=>b.addEventListener('click',e=>e1(parseInt(e.currentTarget.dataset.pointId,10)||i,parseInt(e.currentTarget.dataset.recordId))));E.ds.querySelectorAll('.delete-record-btn').forEach(b=>b.addEventListener('click',e=>e2(parseInt(e.currentTarget.dataset.pointId,10)||i,parseInt(e.currentTarget.dataset.recordId))));E.ds.querySelector('.quick-add-record-btn')?.addEventListener('click',()=>q1(i));E.ds.querySelector('.sidebar-sequence-input')?.addEventListener('change',h10)}}function q1(i){h7('tc1');E.spd.value=i;h8();const p=[...S.d['233'],...S.d['666']].find(x=>x.id===i);_t(`为点位 "${p.name}" 准备添加新记录。`,'info')}function d5(){E.ds.innerHTML=`<i class="fas fa-map-marker-alt" style="font-size: 3rem; color: rgba(74, 175, 80, 0.5); margin-bottom: 20px;"></i><p>点击地图上的点位查看详细信息</p>`;E.ds.classList.add('empty');S.s=null;S.e=null;document.querySelectorAll('.custom-marker').forEach(m=>m.classList.remove('highlight'));r3()}function r3(){S.s=null;S.e=null;E.spd.value='new-point';['s1','s2','s3','s6','s7','s8','s9'].forEach(i=>E[i].value='');E.s5.value=new Date().toISOString().split('T')[0];E.s4.value='surface';E.sb.textContent='保存监测数据';E.slb.textContent='选择地图点位位置';if(S.m){S.m.remove();S.m=null}S.ml=null;E.ls.style.display='none';E.mc.style.cursor='';S.sl=!1;u3()}function p3(){const p=(S.d[S.c]||[]).sort((a,b)=>(a.sequence||Infinity)-(b.sequence||Infinity));E.spd.innerHTML='<option value="new-point">--- 新建点位 ---</option>';p.forEach(x=>{const o=document.createElement('option');o.value=x.id;o.textContent=`(序: ${x.sequence??'无'}) ${x.name} (${x.code})`;E.spd.appendChild(o)});E.spd.disabled=!S.l}function r2(){const p=(S.d[S.c]||[]).sort((a,b)=>(a.sequence||Infinity)-(b.sequence||Infinity));E.pc.innerHTML=p.length===0?'<p style="text-align: center; color: #999;">当前地图暂无点位</p>':p.map(x=>`<div class="point-item" data-id="${x.id}"><div><strong>${x.name}</strong> (${x.code})</div><div class="point-meta"><span>${g1(x.waterType||'surface')} | 记录: ${x.records?.length||0}</span><span style="font-weight: bold;">序号: ${x.sequence??'未设置'}</span></div><div style="margin-top: 10px;"><button class="action-btn btn-primary add-record-btn" ${S.l?'':'disabled'}>添加数据</button><button class="action-btn btn-warning edit-point-details-btn" ${S.l?'':'disabled'}>编辑点位</button><button class="action-btn btn-danger delete-point-btn" ${S.l?'':'disabled'}>删除点位</button></div></div>`).join('')}function u3(){const a=S.l;E.cp.classList.toggle('active',a);E.atb.classList.toggle('logged-in',a);E.atb.title=a?`管理员 (点击登出)`:'管理员登录';const f=['sb','g1','g2','g3','g4','g5b1','g5b2','spd','s1','s2','s3','s4','s5','s6','s7','s8','s9','t1','t2'];f.forEach(el=>E[el].disabled=!a);E.dh.style.display=a?'block':'none';E.slb.style.display=a&&E.spd.value==='new-point'&&E.tc1.classList.contains('active')?'block':'none';r1();r2();if(S.s)d4(S.s)}function h10(e){const i=e.target;const d=parseInt(i.dataset.pointId,10);const n=i.value.trim();const v=n===''?null:parseInt(n,10);if(n!==''&&isNaN(v)){_t('输入无效，序号必须是数字。','error');const p=[...S.d['233'],...S.d['666']].find(x=>x.id===d);i.value=p?(p.sequence??''):'';return}const ap=[...S.d['233'],...S.d['666']];const p=ap.find(x=>x.id===d);if(!p)return;const o=p.sequence;if(v!==null&&ap.some(x=>x.id!==d&&x.sequence===v)){_t(`错误：序号 "${v}" 已被其他点位使用。`,'error');i.value=o??'';return}p.sequence=v;s3();_t(`点位 "${p.name}" 的序号已更新。`,'success');r2();p3()}let mro;function init(){E.g1.value=K.owner;E.g2.value=K.repo;E.g3.value=K.file;E.gs1.style.display='flex';l1();i1();u3();p3();E.gs4.addEventListener('click',()=>{E.gs1.style.display='none';_t('已跳过同步，使用本地数据。','info')});E.gs5.addEventListener('click',h1);E.gs2.addEventListener('keypress',e=>e.key==='Enter'&&h1());E.b1.addEventListener('click',()=>s2('233'));E.b2.addEventListener('click',()=>s2('666'));E.atb.addEventListener('click',()=>S.l?h3():(E.apo.style.display='flex'));E.apc.addEventListener('click',()=>E.apo.style.display='none');E.alb.addEventListener('click',h2);E.api.addEventListener('keypress',e=>e.key==='Enter'&&h2());E.sb.addEventListener('click',a2);E.mc.addEventListener('click',h4);E.mc.addEventListener('mousemove',h5);document.addEventListener('mouseup',h9);E.t1.addEventListener('click',()=>h7('tc1'));E.t2.addEventListener('click',()=>h7('tc2'));E.spd.addEventListener('change',h8);E.pc.addEventListener('click',h11);E.g5b1.addEventListener('click',s4);document.querySelector('.export-btn').addEventListener('click',exportToExcel);mro=new ResizeObserver(r1);mro.observe(E.mc);window.addEventListener('resize',d6);window.addEventListener('load',d6);document.addEventListener('contextmenu',e=>{if(!S.l)e.preventDefault()})}let h1,h2,h3,h4,h6,h5,h9,h7,h8,h11,s4,pf1,e1,e2,d6;(function(){h1=async function(){const t=E.gs2.value.trim();E.gs5.disabled=!0;E.gs4.disabled=!0;try{const c={...K,token:t};await pf1(c,E.gs3);setTimeout(()=>{E.gs1.style.display="none"},1500)}catch(e){console.error("e2:",e);E.gs5.disabled=!1;E.gs4.disabled=!1}};h2=function(){if(E.api.value.trim()!==P)return _t("管理员密码错误！","error");S.l=!0;E.apo.style.display="none";E.api.value="";_t("欢迎！已进入管理员模式。","success");u3();p3()};h3=function(){S.l=!1;d5();r3();u3();p3();_t("已安全登出。","info")};h4=function(e){if(!S.l||!S.sl)return;const{displayedWidth:dw,displayedHeight:dh,offsetX:ox,offsetY:oy}=g2();if(dw===0)return;const mc=C[S.c];const cr=E.mc.getBoundingClientRect();const cx=e.clientX-cr.left;const cy=e.clientY-cr.top;if(cx<ox||cx>ox+dw||cy<oy||cy>oy+dh){return _t("请在地图图片范围内点击。","error")}if(S.m)S.m.remove();S.ml={lat:(cy-oy)/dh*mc.intrinsicHeight,lng:(cx-ox)/dw*mc.intrinsicWidth,};const tp={...S.ml,waterType:E.s4.value,code:"新点位"};S.m=c2(tp,!0);_t("已选择地图位置。","info");E.ls.style.display="none";E.mc.style.cursor="";S.sl=!1;E.slb.textContent="重新选择地图点位位置"};h6=function(e){if(!S.l)return;e.stopPropagation();const m=e.currentTarget;S.ig=!0;S.de=m;S.dp=parseInt(m.dataset.pointId);const mr=m.getBoundingClientRect();S.dx=e.clientX-mr.left;S.dy=e.clientY-mr.top;m.style.zIndex="10000";m.style.opacity="0.8"};h5=function(e){if(!S.ig||!S.de)return;e.preventDefault();const cr=E.mc.getBoundingClientRect();let nl=e.clientX-cr.left-S.dx;let nt=e.clientY-cr.top-S.dy;nl=Math.max(0,Math.min(nl,cr.width-S.de.offsetWidth));nt=Math.max(0,Math.min(nt,cr.height-S.de.offsetHeight));S.de.style.left=`${nl}px`;S.de.style.top=`${nt}px`};h9=function(){if(!S.ig||!S.de)return;S.ig=!1;S.de.style.zIndex="500";S.de.style.opacity="1";const{displayedWidth:dw,displayedHeight:dh,offsetX:ox,offsetY:oy}=g2();const mc=C[S.c];const ic=I[S.de.dataset.waterType||"surface"];const mr=S.de.getBoundingClientRect();const cr=E.mc.getBoundingClientRect();const nl=(mr.left-cr.left+ic.iconAnchor[0]-ox)/dw*mc.intrinsicWidth;const nla=(mr.top-cr.top+ic.iconAnchor[1]-oy)/dh*mc.intrinsicHeight;const p=S.d[S.c];const pi=p.findIndex(x=>x.id===S.dp);if(pi!==-1){const x=p[pi];x.lat=nla;x.lng=nl;if(!x.history)x.history=[];x.history.unshift(c1("更新位置",`坐标更新为 (${nla.toFixed(2)}, ${nl.toFixed(2)})`,"管理员"));s3();_t(`点位 "${x.name}" 位置已更新！`,"success")}S.de=null;S.dp=null};h7=function(i){if(!S.l){E.apo.style.display="flex";return _t("请先登录管理员。","error")}if(S.sl){E.ls.style.display="none";E.mc.style.cursor="";S.sl=!1;if(S.m){S.m.remove();S.m=null}}E.tc1.classList.toggle("active",i==="tc1");E.tc2.classList.toggle("active",i==="tc2");E.t1.classList.toggle("active",i==="tc1");E.t2.classList.toggle("active",i==="tc2");if(i==="tc1")r3();else if(i==="tc2")r2();u3()};h8=function(){const i=E.spd.value;if(i==='new-point'){r3()}else{const d=parseInt(i);const p=(S.d[S.c]||[]).find(x=>x.id===d);if(p){S.s=d;S.e=null;E.s1.value=p.sequence??'';E.s2.value=p.code;E.s3.value=p.name;E.s4.value=p.waterType;E.s5.value=new Date().toISOString().split('T')[0];['s6','s7','s8','s9'].forEach(x=>E[x].value='');E.sb.textContent=`为 "${p.name}" 添加新记录`;if(S.m){S.m.remove();S.m=null}S.ml=null;S.sl=!1;u3()}}};h11=function(e){const i=e.target.closest('.point-item');if(!i)return;const d=parseInt(i.dataset.id);const p=(S.d[S.c]||[]).find(x=>x.id===d);if(!p)return;if(e.target.closest('.add-record-btn')){q1(d)}else if(e.target.closest('.edit-point-details-btn')){h7('tc1');E.spd.value=d;S.s=d;S.e=null;E.s1.value=p.sequence??'';E.s2.value=p.code;E.s3.value=p.name;E.s4.value=p.waterType;E.sb.textContent=`更新点位 "${p.name}" 信息`;_t(`正在编辑点位 "${p.name}" 的基本信息。`,'info');u3()}else if(e.target.closest('.delete-point-btn')){if(confirm(`确定要删除点位 "${p.name}" 及其所有记录吗？此操作不可逆！`)){S.d[S.c]=(S.d[S.c]||[]).filter(x=>x.id!==d);s3();r1();r2();p3();if(S.s===d)d5();_t('点位已删除。','success')}}else{d4(d)}};s4=async function(){if(!S.l)return _t("请登录管理员才能保存到云端。","error");const o=E.g1.value.trim();const r=E.g2.value.trim();const f=E.g3.value.trim();const t=E.g4.value.trim();if(!o||!r||!f||!t)return _t("请填写完整的GitHub配置信息！","error");u1("正在保存数据到GitHub...","sync-loading");try{const u=`https://api.github.com/repos/${o}/${r}/contents/${f}`;const h={"Authorization":`token ${t}`,"User-Agent":"Sys"};let s=null;const gr=await fetch(u,{headers:h});if(gr.ok){s=(await gr.json()).sha}else if(gr.status!==404){throw new Error("e3: "+((await gr.json()).message||gr.statusText))}const c=b1(JSON.stringify(S.d));const m=`更新 - ${new Date().toLocaleString()}`;const pr=await fetch(u,{method:"PUT",headers:{...h,"Content-Type":"application/json"},body:JSON.stringify({message:m,content:c,sha:s})});if(!pr.ok)throw new Error("e4: "+((await pr.json()).message||pr.statusText));u1("数据已成功保存到GitHub！","sync-success");u2();_t("数据已保存到云端！","success")}catch(e){console.error("e5:",e);u1(`e6: ${e.message}`,"sync-error");_t(`e7: ${e.message}`,"error")}};pf1=async function(c,s){const{owner:o,repo:r,file:f,token:t}=c;if(!o||!r||!f){const m="e8";u1(m,"sync-error",s);throw new Error(m)}if(!t){const m="e9";u1(m,"sync-error",s);throw new Error(m)}u1("正在从GitHub加载数据...","sync-loading",s);const u=`https://api.github.com/repos/${o}/${r}/contents/${f}`;const op={headers:{"User-Agent":"Sys","Authorization":`token ${t}`}};const res=await fetch(u,op);if(!res.ok){const ed=await res.json();throw new Error(`e10 (${res.status}): ${ed.message||"e11"}`)}const dta=await res.json();const nd=JSON.parse(b2(dta.content));if(typeof nd==="object"&&"233"in nd&&"666"in nd){S.d=nd;s3();l1();i1();r2();p3();d5();u1("数据加载成功！","sync-success",s);u2();_t("数据已从云端加载！","success")}else{throw new Error("e12")}};e1=function(p,i){const x=[...S.d['233'],...S.d['666']].find(d=>d.id===p);if(!x||!x.records)return;const r=x.records.find(d=>d.id===i);if(!r)return;h7('tc1');E.spd.value=p;E.s1.value=x.sequence??'';E.s2.value=x.code;E.s3.value=x.name;E.s4.value=x.waterType;E.s5.value=r.monitoringDate||'';E.s6.value=r.operator||'';E.s7.value=r.zinc??'';E.s8.value=r.manganese??'';E.s9.value=r.notes??'';S.s=p;S.e=i;E.sb.textContent=`更新 "${x.name}" 的记录`;u3();_t(`正在编辑点位 "${x.name}" 的记录。`,'info')};e2=function(p,i){if(!S.l)return _t("无权限。","error");const x=[...S.d["233"],...S.d["666"]].find(d=>d.id===p);if(!x||!x.records)return;if(confirm("确定要删除这条记录吗？")){const r=x.records.find(d=>d.id===i);x.records=x.records.filter(d=>d.id!==i);x.history.unshift(c1("删除记录",`删除了记录 ID: ${i}`,r?.operator||"未知"));s3();_t("记录已删除。","success");d4(p)}};E.slb.addEventListener('click',()=>{S.sl=!0;E.ls.style.display="block";E.mc.style.cursor="crosshair";_t("请点击地图选择点位位置。","info");if(S.m){S.m.remove();S.m=null}E.slb.textContent="重新选择地图点位位置"});document.querySelector('.collapse-btn').addEventListener('click',function(){const i=this.querySelector('i');E.cp.classList.toggle('collapsed');i.className=E.cp.classList.contains('collapsed')?"fas fa-chevron-right":"fas fa-chevron-left"});E.g5b2.addEventListener('click',async()=>{try{await pf1({owner:E.g1.value.trim(),repo:E.g2.value.trim(),file:E.g3.value.trim(),token:E.g4.value.trim()},E.g6)}catch(e){console.error("e13:",e)}});d6=()=>{if(window.outerWidth-window.innerWidth>160||window.outerHeight-window.innerHeight>160){E.dvo.style.display="flex"}else{E.dvo.style.display="none"}}})();init()})
    </script>
</body>
</html>
